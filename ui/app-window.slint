import { Attribute } from "global.slint";
import { TabWidget } from "std-widgets.slint";
import { Items } from "items.slint";
import { Lyric } from "lyric.slint";
import { Config } from "config.slint";
import { MusicInfo } from "type.slint";

// 导出全局信息到入口提供给 Rust 访问
export { Attribute }

// 程序主窗口
export component AppWindow inherits Window {
    title: Attribute.top-title;
    min-width: 600px;
    min-height: 700px;
    preferred-width: 600px;
    preferred-height: 700px;
    default-font-family: Attribute.default-font-family;

    // 请求打开文件或者文件夹
    callback select-files();
    // 双击播放歌曲
    callback playback(MusicInfo);
    // 乱序播放
    callback hope-shuffle-play(bool);
    // 上一首播放
    callback play-prev();
    // 下一首播放
    callback play-next();
    // 列表重复播放
    callback hope-repeat-play(bool);
    // 当前播放
    callback current-play();
    // 当前暂停
    callback current-pause();
    // 改变歌曲播放进度
    callback change-progress(float);

    TabWidget {
        Tab {
            title: @tr("歌曲");
            Rectangle {
                width: 100%;
                height: 100%;
                Items {
                    width: 100%;
                    height: 100%;
                    playback(music-info) => {
                        root.playback(music-info);
                    }
                    hope-shuffle-play(mode-info) => {
                        root.hope-shuffle-play(mode-info);
                    }

                    play-prev => {
                        root.play-prev();
                    }

                    play-next => {
                        root.play-next();
                    }

                    hope-repeat-play(mode-info) => {
                        root.hope-repeat-play(mode-info);
                    }

                    current-play => {
                        root.current-play();
                    }

                    current-pause => {
                        root.current-pause();
                    }

                    change-progress(val) => {
                        root.change-progress(val);
                    }
                }
            }
        }

        Tab {
            title: @tr("歌词");
            Rectangle {
                width: 100%;
                height: 100%;

                Lyric {
                    width: 100%;
                    height: 100%;

                    hope-shuffle-play(mode-info) => {
                        root.hope-shuffle-play(mode-info);
                    }

                    play-prev => {
                        root.play-prev();
                    }

                    play-next => {
                        root.play-next();
                    }

                    hope-repeat-play(mode-info) => {
                        root.hope-repeat-play(mode-info);
                    }

                    current-play => {
                        root.current-play();
                    }

                    current-pause => {
                        root.current-pause();
                    }

                    change-progress(val) => {
                        root.change-progress(val);
                    }
                }
            }
        }

        Tab {
            title: @tr("配置");
            Rectangle {
                width: 100%;
                height: 100%;
                Config {
                    width: 100%;
                    height: 100%;
                    select-files => {
                        root.select-files();
                    }
                }
            }
        }

        Tab {
            title: @tr("关于");
            Rectangle {
                width: 100%;
                height: 100%;
            }
        }
    }
}
